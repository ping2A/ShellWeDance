name: Remarkably suspicious keywords
description: This indicator holds a long list of keywords potentially linked to malicious activity. It's among the few pattern indicators with the highest base score (10). It was initially inspired and later expanded from a few Sigma detections (refer to references). Also refer to other indicators ending with 'keywords' as they also accomodate multiple keywords but for lower signals. Keywords might be removed and added to a more specific indicator in the future.
regex: Invoke-(DllInjection|CredentialInjection|EnumerateLocalAdmin|Portscan|ShadowCopy|DllCanUnloadNow|Mimikatz|PrivescAudit|ReverseDnsLookup|WmiCommand|TokenManipulation|posh|ShadowCred|LDAPEnum|PassTheCert|sharefinder|RunAsSystem|NetStat|ADeleginator|ScriptSentry)|UnsafeNativeMethods|GuiltySpark|-Impersonate|PsMapExec|ksetup.+dumpstate|system32[\\]+microsoft[\\]+protect|wmiclass|Add-DnsClientNrptRule|TransformFinalBlock|Base64Transform|-AsByteStream|Get-CachedRDPConnection|Get-CurrentUserTokenGroupsid|Get-DFSshare|Get-DNSRecord|Get-DNSZone|Get-DomainPolicy|Find-AVSignature|Get-GPPAutologon|Get-GPPPassword|Get-HttpStatus|Get-MicrophoneAudio|Get-SecurityPackage|Get-VolumeShadowCopy|set-ADComputer|new-object.+DirectoryEntry|p0wned|Mount-VolumeShadowCopy|New-ElevatedPersistenceOption|New-UserPersistenceOption|New-VolumeShadowCopy|rdrleakdiag|Out-CompressedDll|Out-EncodedCommand|Out-EncryptedScript|PrivescAudit|Remove-VolumeShadowCopy|Set-CriticalProcess|Set-MasterBootRecord|powersploit|fltMC.+unload|BinaryWritableServices|\bunrar\.exe\b|DomainShare|DomainFileServer|DomainRecon|Get-ActiveDirectoryUserGroups|Add-DomainUserToLocalGroup|(get|add)-DomainUser|(get|add)-DomainComputer|Connect-FTP|Add-HostFileEntry|Connect-HTTP|InternetExplorerEnhancedSecurityConfiguration|PowerShellPowerUp|Connect-RDP|Get-RemoteConnection|Update-ScheduledTask|UserImpersonation|DomainSPNTicket|\S+-Interesting\S+|Add-ADGroupMember.+admin|NetRDPSession|termsrv\.dll|Get-Tcp4Connections|RDPSharedDrives|-Jitter\s|PasswordSpray|HostEnum|AVProcesses|-netuser|ActiveTCPConnections|-MachineAccount|Get-Process\s+-Name\s+lsass|PasswordNotRequired.*true|new-machineaccount|RegBackdoor|ScrnSaveBackdoor|-Backdoor|ADSBackdoor|BackdoorLNK|Invoke-ACLScanner|Mimikatz|SMBScanner|-PowerDump|ReflectivePEInjection|ARPScan|(nishang|Inveigh|WINspect)\.ps1|Install-ServiceBinary|AllowedToActOnBehalfOfOtherIdentity|DNSDiscovery|Invoke-PSInject|Invoke-PsUaCme|Out-Minidump|Invoke-NetRipper|Mimikittenz|psrecon|AmsiBypass|recurs.+pass.+cred|invoke-mass|-Vnc\b|CredentialInjection|BypassUAC|DowngradeAccount|VulnAutoRun|VulnSchTask|HoneyHash|TimedScreenshot|Kerberoast|CradleCrafter|Kittielocal|keylogger|-Locksmith|-nightmare|-attack\b|VolumeShadowCopyTools|invoke-dll|PingSweep|Reverse(Power)*Shell|CheckLocalAdminAccess|CaptureServer|PowerBreach|UserHunter|Invoke-ThunderStruck|WScriptBypassUAC|Invoke-VoiceTroll|Invoke-WinEnum|Invoke-Shellcode|Invoke-NinjaCopy|Invoke-Paranoia|Get-Screenshot|Get-Keystrokes|LSASecret|Get-PassHash|Get-ChromeDump|Get-FoxDump|Do-Exfiltration|Enabled-DuplicateToken|Exploit-|EventVwrBypass|Find-AllVulns|Add-Exfiltration|Add-Persistence|PersistenceSniper|sharefinder|Invoke-FileFinder|-smb\S+brute
max_match: 1
basescore: 10
tactic: TA0002
technique: T1059.001
reference:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_malicious_cmdlets.yml
