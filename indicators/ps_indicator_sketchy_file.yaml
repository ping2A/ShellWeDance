name: Sketchy file name
description: Detects references to potential suspicious script/binary filenames commonly used for webshells, droppers, or staged payloads (e.g., short/random names, tmp/upload/download/admin/backdoor/beacon/tunnel/cmd/exfil/scan patterns) with some notable extensions.
regex: \b['\"\\\/:!&@\$\s](\d{1,3}|[a-z]{1,2}|[a-z]\d{1,2}|[za]{2,}|tmp\d*|upload\d*|download\d*|admin\d*|backdoor\d*|beacon\d*|tunnel\d*|[^\.]*cmd\d*|command\d*|[^\.]*exfil.*|[^\.]*backdoor\d*|[^\.]*scan\d*)(\.(jpg|gif|png))*\.(php\d*|aspx*|pl|cgi|py|bat|cmd|vbs|js|dll|bin|txt)['\"\\\/:!&@\$\s]*\b
basescore: 8.6
tactic: [TA0002, TA0005]
technique: [T1505.003, T1036]
reference:
  - https://bughra.dev/posts/file-upload/
  - https://attack.mitre.org/techniques/T1505/003/
  - https://attack.mitre.org/techniques/T1036/
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1505.003/T1505.003.md
