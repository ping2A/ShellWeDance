name: Remote command
description: >
  Detects PowerShell command lines that specify a remote target via common “remote host”
  parameters (e.g., -ComputerName / -TargetName). This is frequently associated with
  remote command execution and lateral movement using PowerShell remoting/WinRM
  (e.g., Invoke-Command, Enter-PSSession, New-PSSession) and other cmdlets that accept
  a remote computer target.

  Note that the unicodes below refer to Hyphen-Minus (ASCII hyphen), En/m Dash and Horizontal Bar.
  Refer to FAQ entry 3.1 in the reference to use those in Splunk/SPL.
regex: \s+[\u002D\u2013\u2014\u2015](ComputerName|TargetName)\s+[^.\s]
basescore: 6
tactic: [TA0002, TA0008]
technique: [T1059.001, T1021.006]
reference:
  - https://attack.mitre.org/techniques/T1021/006/
  - https://attack.mitre.org/techniques/T1059/001/
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_invoke_command_remote.yml
  - https://www.atomicredteam.io/atomic-red-team/atomics/T1021.006
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1021.006/T1021.006.md
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1021.006/T1021.006.yaml
  - https://github.com/avasero/psexposed/blob/main/FAQ.md#31-a-few-notes-to-consider-when-using-regex-in-splunkspl
